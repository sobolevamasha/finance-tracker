import{d as K,r as S,c as f,u as Q,w as W,a as v,b as B,o as p,e as t,t as d,f as R,n as I,g as k,v as F,h as X,F as V,i as A,s as Y,j as Z,k as tt,l as et,m as w}from"./index-gnLrAdqL.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";const L=K("transactions",()=>{const l=S([{id:1,amount:-1500,category:"food",description:"–û–±–µ–¥ –≤ –∫–∞—Ñ–µ",date:"2024-01-15"},{id:2,amount:5e4,category:"salary",description:"–ó–∞—Ä–ø–ª–∞—Ç–∞",date:"2024-01-10"},{id:3,amount:-300,category:"transport",description:"–¢–∞–∫—Å–∏",date:"2024-01-15"}]),T=e=>{l.value.push({id:Date.now(),...e})},r=e=>{l.value=l.value.filter(c=>c.id!==e)},y=f(()=>l.value.reduce((e,c)=>e+c.amount,0));return{transactions:l,addTransaction:T,deleteTransaction:r,updateTransaction:(e,c)=>{const m=l.value.findIndex(g=>g.id===e);m!==-1&&(l.value[m]={...l.value[m],...c})},getTransactionById:e=>l.value.find(c=>c.id===e),totalBalance:y}}),at={class:"transaction-form card"},st={class:"form-group"},nt={class:"type-toggle"},ot={class:"form-group"},lt={class:"form-group"},it=["value"],rt={class:"form-group"},ct={class:"form-group"},ut={class:"form-actions"},dt={type:"submit",class:"btn btn--primary"},mt={__name:"TransactionForm",props:{visible:Boolean,editingTransaction:Object},emits:["close"],setup(l,{emit:T}){const r=l,y=T,_=L(),h=Q(),e=S({type:"expense",amount:"",category:"",description:"",date:new Date().toISOString().split("T")[0]}),c=f(()=>[{value:"food",label:"üçï –ï–¥–∞"},{value:"transport",label:"üöï –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç"},{value:"shopping",label:"üõçÔ∏è –®–æ–ø–ø–∏–Ω–≥"},{value:"entertainment",label:"üé¨ –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è"},{value:"health",label:"üè• –ó–¥–æ—Ä–æ–≤—å–µ"},{value:"bills",label:"üè† –ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ"},{value:"salary",label:"üí∞ –ó–∞—Ä–ø–ª–∞—Ç–∞"},{value:"freelance",label:"üíº –§—Ä–∏–ª–∞–Ω—Å"},{value:"other",label:"üì¶ –î—Ä—É–≥–æ–µ"}]),m=async()=>{console.log("üîç form.value:",JSON.stringify(e.value,null,2));const i=e.value.type==="income"?+e.value.amount:-Math.abs(+e.value.amount),a={amount:i,category:e.value.category||"other",description:e.value.description||"–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è",date:e.value.date};console.log("üìù –¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏:",e.value.type),console.log("üìù –°—É–º–º–∞:",i);const o=e.value.type==="income";console.log("üîç isIncome:",o),o?(console.log("üí∞ –ó–ê–ü–£–°–ö–ê–ï–ú –ê–ù–ò–ú–ê–¶–ò–Æ –î–ï–ù–ï–ì!"),h.triggerMoneyAnimation(),await new Promise(C=>setTimeout(C,2e3))):console.log("üì§ –≠—Ç–æ —Ä–∞—Å—Ö–æ–¥, –∞–Ω–∏–º–∞—Ü–∏—è –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è"),g(a)},g=i=>{r.editingTransaction?_.updateTransaction(r.editingTransaction.id,i):_.addTransaction(i),$()},x=()=>{e.value={type:"expense",amount:"",category:"",description:"",date:new Date().toISOString().split("T")[0]}},$=()=>{x(),y("close")};return W(()=>r.editingTransaction,i=>{i?e.value={type:i.amount>0?"income":"expense",amount:Math.abs(i.amount),category:i.category,description:i.description,date:i.date}:x()}),(i,a)=>l.visible?(p(),v("div",{key:0,class:"transaction-form-overlay",onClick:R($,["self"])},[t("div",at,[t("h2",null,d(l.editingTransaction?"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å":"–î–æ–±–∞–≤–∏—Ç—å")+" –æ–ø–µ—Ä–∞—Ü–∏—é",1),t("form",{onSubmit:R(m,["prevent"])},[t("div",st,[a[6]||(a[6]=t("label",{class:"form-label"},"–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏",-1)),t("div",nt,[t("button",{type:"button",class:I(["type-btn",{"type-btn--active":e.value.type==="income"}]),onClick:a[0]||(a[0]=o=>e.value.type="income")}," üì• –î–æ—Ö–æ–¥ ",2),t("button",{type:"button",class:I(["type-btn",{"type-btn--active":e.value.type==="expense"}]),onClick:a[1]||(a[1]=o=>e.value.type="expense")}," üì§ –†–∞—Å—Ö–æ–¥ ",2)])]),t("div",ot,[a[7]||(a[7]=t("label",{class:"form-label"},"–°—É–º–º–∞",-1)),k(t("input",{type:"number",class:"form-input",placeholder:"0","onUpdate:modelValue":a[2]||(a[2]=o=>e.value.amount=o),required:""},null,512),[[F,e.value.amount]])]),t("div",lt,[a[9]||(a[9]=t("label",{class:"form-label"},"–ö–∞—Ç–µ–≥–æ—Ä–∏—è",-1)),k(t("select",{class:"form-input","onUpdate:modelValue":a[3]||(a[3]=o=>e.value.category=o)},[a[8]||(a[8]=t("option",{value:""},"–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é",-1)),(p(!0),v(V,null,A(c.value,o=>(p(),v("option",{key:o.value,value:o.value},d(o.label),9,it))),128))],512),[[X,e.value.category]])]),t("div",rt,[a[10]||(a[10]=t("label",{class:"form-label"},"–û–ø–∏—Å–∞–Ω–∏–µ",-1)),k(t("input",{type:"text",class:"form-input",placeholder:"–ù–∞–ø—Ä–∏–º–µ—Ä: –û–±–µ–¥ –≤ –∫–∞—Ñ–µ","onUpdate:modelValue":a[4]||(a[4]=o=>e.value.description=o)},null,512),[[F,e.value.description]])]),t("div",ct,[a[11]||(a[11]=t("label",{class:"form-label"},"–î–∞—Ç–∞",-1)),k(t("input",{type:"date",class:"form-input","onUpdate:modelValue":a[5]||(a[5]=o=>e.value.date=o)},null,512),[[F,e.value.date]])]),t("div",ut,[t("button",{type:"button",class:"btn btn--danger",onClick:$},"–û—Ç–º–µ–Ω–∞"),t("button",dt,d(l.editingTransaction?"–û–±–Ω–æ–≤–∏—Ç—å":"–î–æ–±–∞–≤–∏—Ç—å"),1)])],32)])])):B("",!0)}},vt=O(mt,[["__scopeId","data-v-195bbe3d"]]),pt={class:"container"},bt={key:0,class:"header"},ft={class:"user-info"},gt={key:1,class:"text-center"},yt={class:"balance-card"},_t={class:"stats-grid"},Tt={class:"stat-card"},ht={class:"stat-amount text-success"},xt={class:"stat-card"},$t={class:"stat-amount text-danger"},kt={class:"card"},wt={class:"card-header"},St={class:"transactions-list"},It=["onClick"],Ct={class:"transaction-info"},Dt={class:"transaction-description"},Ft={class:"transaction-category"},Bt={class:"transaction-date"},Ut={key:0,class:"empty-state"},Mt={__name:"Dashboard",setup(l){const T=L(),{transactions:r,totalBalance:y}=Y(T),{isTelegram:_,user:h,showMainButton:e,showAlert:c}=Z(),m=S(!1),g=S(null),x={food:"üçï –ï–¥–∞",transport:"üöï –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç",shopping:"üõçÔ∏è –®–æ–ø–ø–∏–Ω–≥",entertainment:"üé¨ –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è",health:"üè• –ó–¥–æ—Ä–æ–≤—å–µ",bills:"üè† –ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ",salary:"üí∞ –ó–∞—Ä–ø–ª–∞—Ç–∞",freelance:"üíº –§—Ä–∏–ª–∞–Ω—Å",other:"üì¶ –î—Ä—É–≥–æ–µ"},$=f(()=>new Intl.NumberFormat("ru-RU").format(y.value)),i=f(()=>new Intl.NumberFormat("ru-RU").format(C.value)),a=f(()=>new Intl.NumberFormat("ru-RU").format(j.value)),o=f(()=>({"balance-amount--positive":y.value>=0,"balance-amount--negative":y.value<0})),C=f(()=>r.value.filter(s=>s.amount>0).reduce((s,n)=>s+n.amount,0)),j=f(()=>Math.abs(r.value.filter(s=>s.amount<0).reduce((s,n)=>s+n.amount,0))),E=f(()=>[...r.value].sort((s,n)=>new Date(n.date)-new Date(s.date)).slice(0,10)),U=()=>{g.value=null,m.value=!0},q=s=>{g.value=s,m.value=!0},z=()=>{m.value=!1,g.value=null},M=s=>x[s]||x.other,J=s=>({"transaction-amount--income":s.amount>0,"transaction-amount--expense":s.amount<0}),P=s=>`${s>0?"+":""}${new Intl.NumberFormat("ru-RU").format(s)} ‚ÇΩ`,G=s=>new Date(s).toLocaleDateString("ru-RU"),H=()=>{const n=["–î–∞—Ç–∞,–û–ø–∏—Å–∞–Ω–∏–µ,–ö–∞—Ç–µ–≥–æ—Ä–∏—è,–°—É–º–º–∞,–¢–∏–ø",...r.value.map(u=>({–î–∞—Ç–∞:u.date,–û–ø–∏—Å–∞–Ω–∏–µ:u.description,–ö–∞—Ç–µ–≥–æ—Ä–∏—è:M(u.category),–°—É–º–º–∞:u.amount,–¢–∏–ø:u.amount>0?"–î–æ—Ö–æ–¥":"–†–∞—Å—Ö–æ–¥"})).map(u=>`"${u.–î–∞—Ç–∞}","${u.–û–ø–∏—Å–∞–Ω–∏–µ}","${u.–ö–∞—Ç–µ–≥–æ—Ä–∏—è}",${u.–°—É–º–º–∞},"${u.–¢–∏–ø}"`)].join(`
`),b=new Blob([n],{type:"text/csv"}),N=URL.createObjectURL(b),D=document.createElement("a");D.href=N,D.download=`—Ñ–∏–Ω–∞–Ω—Å—ã_${new Date().toISOString().split("T")[0]}.csv`,D.click(),c("–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ CSV —Ñ–∞–π–ª!")};return tt(()=>{_&&e("–î–æ–±–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é",U)}),(s,n)=>(p(),v("div",pt,[w(h)?(p(),v("div",bt,[n[0]||(n[0]=t("h1",null,"üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –¢—Ä–µ–∫–µ—Ä",-1)),t("div",ft,[t("span",null,"–ü—Ä–∏–≤–µ—Ç, "+d(w(h).first_name)+"!",1)])])):(p(),v("h1",gt,"üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –¢—Ä–µ–∫–µ—Ä")),t("div",yt,[n[1]||(n[1]=t("div",{class:"balance-label"},"–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å",-1)),t("div",{class:I(["balance-amount",o.value])},d($.value),3)]),t("div",_t,[t("div",Tt,[n[2]||(n[2]=t("div",{class:"stat-label"},"–î–æ—Ö–æ–¥—ã",-1)),t("div",ht,"+"+d(i.value)+" ‚ÇΩ",1)]),t("div",xt,[n[3]||(n[3]=t("div",{class:"stat-label"},"–†–∞—Å—Ö–æ–¥—ã",-1)),t("div",$t,"-"+d(a.value)+" ‚ÇΩ",1)])]),t("button",{class:"btn btn--primary btn--block btn--lg",onClick:U}," + –î–æ–±–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é "),t("div",kt,[t("div",wt,[n[4]||(n[4]=t("h3",null,"–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏",-1)),w(_)?(p(),v("button",{key:0,class:"btn btn--text",onClick:H}," üì§ –≠–∫—Å–ø–æ—Ä—Ç ")):B("",!0)]),t("div",St,[(p(!0),v(V,null,A(E.value,b=>(p(),v("div",{key:b.id,class:"transaction-item list-item--interactive",onClick:N=>q(b)},[t("div",Ct,[t("div",Dt,d(b.description),1),t("div",Ft,d(M(b.category)),1),t("div",Bt,d(G(b.date)),1)]),t("div",{class:I(["transaction-amount",J(b)])},d(P(b.amount)),3)],8,It))),128)),w(r).length===0?(p(),v("div",Ut,[...n[5]||(n[5]=[t("p",null,"üìù –ü–æ–∫–∞ –Ω–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π",-1),t("p",{class:"text-muted"},"–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –æ–ø–µ—Ä–∞—Ü–∏—é!",-1)])])):B("",!0)])]),et(vt,{visible:m.value,"editing-transaction":g.value,onClose:z},null,8,["visible","editing-transaction"])]))}},Vt=O(Mt,[["__scopeId","data-v-b7834c71"]]);export{Vt as default};
